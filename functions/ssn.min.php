<?php function checkLastDigit($ssn){$ssn=str_replace('-','',$ssn);$lastDigit=intval(substr($ssn,-1));$ssn=substr($ssn,2,9);$products='';for($i=0;strlen($ssn)>$i;$i++){$products.=(($i%2)==0)?(intval($ssn[$i])*2):(intval($ssn[$i])*1);}$sum=0;for($j=0;strlen($products)>$j;$j++){$sum+=intval($products[$j]);}return ((10-($sum%10))%10)===$lastDigit?true:false;}function validate($ssn){return preg_match('/(19|20)\d{2}((0(1|3|5|7|8)|1(0|2))(0[1-9]|1[0-9]|2[0-9]|3[0-1])|02(0[1-9]|1[0-9]|2[0-9])|(0(4|6|9)|11)(0[1-9]|1[0-9]|2[0-9]|30))\-\d{4}/',$ssn)?true:false;}
